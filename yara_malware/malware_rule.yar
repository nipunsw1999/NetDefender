rule Detect_Hidden_Delete_Payload
{
    meta:
        description = "Detects obfuscated or hidden deletecommands inside images"
        author = "NetDefender"
        date = "2025-03-08"

    strings:
        $delete_plain = "rm -rf" nocase
        $delete_base64 = "cm0gLXJm"
        $delete_hex = { 72 6D ?? 2D 72 66 }
        $python_exec = "os.system(" nocase
        $bash_exec = "bash -c" nocase
        $stegano_marker = "steghide" nocase
        $zip_magic = { 50 4B 03 04 }
        $jpg_exif = { FF E1 }
        $png_exif = { 89 50 4E 47 }

    condition:
        any of them
}
