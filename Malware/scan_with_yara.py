import os
import subprocess

# Define the directory to scan
SCAN_DIR = "/home/malisha/Downloads"  # Change this to the actual directory you want to scan

# Define the YARA rule file
YARA_RULE = "malware_rule.yar"

def scan_files():
    for file in os.listdir(SCAN_DIR):
        file_path = os.path.join(SCAN_DIR, file)
        
        # Run YARA scan
        result = subprocess.run(["yara", YARA_RULE, file_path], capture_output=True, text=True)
        
        if result.stdout:
            print(f"⚠️ Malware detected in {file}:\n{result.stdout}")
        else:
            print(f"✅ No threats found in {file}")

if __name__ == "__main__":
    scan_files()
