///install Yara
$ sudo apt install -y yara
//Create a YARA Rule for Malware Detection
$ nano malware_rule.yar

//inside the terminal copy and paste the below code

rule Dangerous_Delete_Command {
    meta:
        description = "Detects scripts that delete system files"
        author = "NetDefender"
        date = "2025-02-13"
    strings:
        $python_import = "import os"
        $delete_command = "os.system('rm -rf /')"
    condition:
        $python_import and $delete_command
}

//save it and exit

///To create Automate YARA Scanning in NetDefender

nano scan_with_yara.py

//inside the terminal copy and paste the below code

import os
import subprocess

# Define the directory to scan
SCAN_DIR = "./downloads"  # Change this to the actual directory you want to scan

# Define the YARA rule file
YARA_RULE = "malware_rule.yar"

def scan_files():
    for file in os.listdir(SCAN_DIR):
        file_path = os.path.join(SCAN_DIR, file)
        
        # Run YARA scan
        result = subprocess.run(["yara", YARA_RULE, file_path], capture_output=True, text=True)
        
        if result.stdout:
            print(f"⚠️ Malware detected in {file}:\n{result.stdout}")
        else:
            print(f"✅ No threats found in {file}")

if __name__ == "__main__":
    scan_files()

//save and exit

///To run the scanner

python3 scan_with_yara.py

